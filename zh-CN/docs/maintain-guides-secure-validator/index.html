<!doctype html>
<html lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="search" type="application/opensearchdescription+xml" title="Guide" href="/zh-CN/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.web3.foundation/latest.js" async defer="defer"></script>
<script src="/js/custom.js"></script>
<script src="/js/clipboard.min.js"></script>
<script src="/js/copycode.js"></script><title data-react-helmet="true">Secure Validator · Guide</title><meta data-react-helmet="true" property="og:url" content="https://guide.kusama.network/zh-CN/docs/maintain-guides-secure-validator"><meta data-react-helmet="true" name="docsearch:language" content="zh-CN"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Secure Validator · Guide"><meta data-react-helmet="true" name="description" content="Validators in a Proof of Stake network are responsible for keeping the network in consensus and"><meta data-react-helmet="true" property="og:description" content="Validators in a Proof of Stake network are responsible for keeping the network in consensus and"><link data-react-helmet="true" rel="shortcut icon" href="/zh-CN/img/Kusama_Canary_white.png"><link data-react-helmet="true" rel="canonical" href="https://guide.kusama.network/zh-CN/docs/maintain-guides-secure-validator"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-secure-validator" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/zh-CN/docs/maintain-guides-secure-validator" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-secure-validator" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-CN/assets/css/styles.e70a5d2b.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.0b6b002f.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.ba81d42f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">跳到主要内容</a></div><div class="announcementBar_3WsW" style="background-color:#e6007a" role="banner"><div class="announcementBarContent_3EUC"><a id="support_us" href="/docs/contributing" title="Contribute to this wiki" data-ribbon="Contribute to this wiki">
          Contribute to this wiki
        </a></div></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><img src="/zh-CN/img/Kusama_logotype_white_large.png" alt="Guide" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/zh-CN/img/Kusama_logotype_white_large.png" alt="Guide" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Guide</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-CN/docs/kusama-getting-started">Get Started</a><a class="navbar__item navbar__link" href="/zh-CN/docs/kusama-index">Docs</a><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>中文</span></span></a><ul class="dropdown__menu"><li><a href="/docs/maintain-guides-secure-validator" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh-CN/docs/maintain-guides-secure-validator" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">中文</a></li><li><a href="https://crowdin.com/project/polkadot-wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help us translate</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Secure Validator</h1></header><p>Validators in a Proof of Stake network are responsible for keeping the network in consensus and
verifying state transitions. As the number of validators is limited, validators in the set have the
responsibility to be online and faithfully execute their tasks.</p><p>This primarily means that validators:</p><ul><li>Must be high availability.</li><li>Must have infrastructure that protects the validator&#x27;s signing keys so that an attacker cannot
take control and commit slashable behavior.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="high-availability"></a>High Availability<a class="hash-link" href="#high-availability" title="标题的直接链接">#</a></h2><p>High availability set-ups that involve redundant validator nodes may seem attractive at first.
However, they can be <strong>very dangerous</strong> if they are not set up perfectly. The reason for this is
that the session keys used by a validator should always be isolated to just a single node.
Replicating session keys across multiple nodes could lead to equivocation slashes or parachain
validity slashes which can make you lose <strong>100% of your staked funds</strong>.</p><p>The good news is that 100% uptime of your validator is not really needed, as it has some buffer
within eras in order to go offline for a little while and upgrade. For this reason, we advise that
you only attempt a high availability set-up if <strong>you&#x27;re confident you know exactly what you&#x27;re
doing.</strong></p><p>Many expert validators have made mistakes in the past due to the handling of session keys.</p><p>Remember, even if your validator goes offline for some time, the offline slash is much more
forgiving than the equivocation or parachain validity slashing.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="key-management"></a>Key Management<a class="hash-link" href="#key-management" title="标题的直接链接">#</a></h2><p>See the <a href="/zh-CN/docs/learn-keys">Polkadot Keys guide</a> for more information on keys. The keys that are of
primary concern for validator infrastructure are the Session keys. These keys sign messages related
to consensus and parachains. Although Session keys are <em>not</em> account keys and therefore cannot
transfer funds, an attacker could use them to commit slashable behavior.</p><p>Session keys are generated inside the node via RPC call. See the
<a href="/zh-CN/docs/maintain-guides-how-to-validate-polkadot#set-session-keys">How to Validate guide</a></p><p>for instructions on setting Session keys. These should be generated and kept within your client.
When you generate new Session keys, you must submit an extrinsic (a Session certificate) from your
Controller key telling the chain your new Session keys.</p><blockquote><p><strong>NOTE:</strong> Session keys can also be generated outside the client and inserted into the client&#x27;s
keystore via RPC. For most users, we recommend using the key generation functionality within the
client.</p></blockquote><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="signing-outside-the-client"></a>Signing Outside the Client<a class="hash-link" href="#signing-outside-the-client" title="标题的直接链接">#</a></h3><p>In the future, Polkadot will support signing payloads outside the client so that keys can be stored
on another device, e.g. a hardware security module (HSM) or secure enclave. For the time being,
however, Session key signatures are performed within the client.</p><blockquote><p><strong>NOTE:</strong> HSMs are not a panacea. They do not incorporate any logic and will just sign and return
whatever payload they receive. Therefore, an attacker who gains access to your validator node
could still commit slashable behavior.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="monitoring-tools"></a>Monitoring Tools<a class="hash-link" href="#monitoring-tools" title="标题的直接链接">#</a></h2><ul><li><p><a href="https://github.com/paritytech/substrate-telemetry" target="_blank" rel="noopener noreferrer">Telemetry</a> This tracks your node details
including the version you are running, block height, CPU &amp; memory usage, block propagation time,
etc.</p></li><li><p><a href="https://prometheus.io/" target="_blank" rel="noopener noreferrer">Prometheus</a>-based monitoring stack, including
<a href="https://grafana.com" target="_blank" rel="noopener noreferrer">Grafana</a> for dashboards and log aggregation. It includes alerting, querying,
visualization, and monitoring features and works for both cloud and on-premise systems. The data
from <code>substrate-telemetry</code> can be made available to Prometheus through exporters like
<a href="https://github.com/w3f/substrate-telemetry-exporter" target="_blank" rel="noopener noreferrer">this</a>.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="linux-best-practices"></a>Linux Best Practices<a class="hash-link" href="#linux-best-practices" title="标题的直接链接">#</a></h2><ul><li>Never use the root user.</li><li>Always update the security patches for your OS.</li><li>Enable and set up a firewall.</li><li>Never allow password-based SSH, only use key-based access.</li><li>Disable non-essential SSH subsystems (banner, motd, scp, X11 forwarding) and harden your SSH
configuration
(<a href="https://stribika.github.io/2015/01/04/secure-secure-shell.html" target="_blank" rel="noopener noreferrer">reasonable guide to begin with</a>).</li><li>Back up your storage regularly.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="conclusions"></a>Conclusions<a class="hash-link" href="#conclusions" title="标题的直接链接">#</a></h2><ul><li><p>At the moment, Polkadot/Substrate can&#x27;t interact with HSM/SGX, so we need to provide the signing
key seeds to the validator machine. This key is kept in memory for signing operations and
persisted to disk (encrypted with a password).</p></li><li><p>Given that HA setups would always be at risk of double-signing and there&#x27;s currently no built-in
mechanism to prevent it, we propose having a single instance of the validator to avoid slashing.
Slashing penalties for being offline are much less than those for equivocation.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="validators"></a>Validators<a class="hash-link" href="#validators" title="标题的直接链接">#</a></h3><ul><li><p>Validators should only run the Polkadot binary, and they should not listen on any port other than
the configured p2p port.</p></li><li><p>Validators should run on bare-metal machines, as opposed to VMs. This will prevent some of the
availability issues with cloud providers, along with potential attacks from other VMs on the same
hardware. The provisioning of the validator machine should be automated and defined in code. This
code should be kept in private version control, reviewed, audited, and tested.</p></li><li><p>Session keys should be generated and provided in a secure way.</p></li><li><p>Polkadot should be started at boot and restarted if stopped for any reason (supervisor process).</p></li><li><p>Polkadot should run as a non-root user.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="monitoring"></a>Monitoring<a class="hash-link" href="#monitoring" title="标题的直接链接">#</a></h3><ul><li><p>There should be an on-call rotation for managing the alerts.</p></li><li><p>There should be a clear protocol with actions to perform for each level of each alert and an
escalation policy.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="resources"></a>Resources<a class="hash-link" href="#resources" title="标题的直接链接">#</a></h2><ul><li><a href="https://medium.com/figment-networks/full-disclosure-figments-cosmos-validator-infrastructure-3bc707283967" target="_blank" rel="noopener noreferrer">Figment Network&#x27;s Full Disclosure of Cosmos Validator Infrastructure</a></li><li><a href="https://kb.certus.one/" target="_blank" rel="noopener noreferrer">Certus One&#x27;s Knowledge Base</a></li><li><a href="https://github.com/slowmist/eos-bp-nodes-security-checklist" target="_blank" rel="noopener noreferrer">EOS Block Producer Security List</a></li><li><a href="https://medium.com/loom-network/hsm-policies-and-the-importance-of-validator-security-ec8a4cc1b6f" target="_blank" rel="noopener noreferrer">HSM Policies and the Important of Validator Security</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/w3f/polkadot-wiki/edit/master/docs/maintain-guides-secure-validator.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_3DPF">最后由 <b>Danny Salman</b> 于 <b><time datetime="2021-08-12T22:58:23.000Z">2021/8/12</time></b> 更新</div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#high-availability" class="table-of-contents__link">High Availability</a></li><li><a href="#key-management" class="table-of-contents__link">Key Management</a><ul><li><a href="#signing-outside-the-client" class="table-of-contents__link">Signing Outside the Client</a></li></ul></li><li><a href="#monitoring-tools" class="table-of-contents__link">Monitoring Tools</a></li><li><a href="#linux-best-practices" class="table-of-contents__link">Linux Best Practices</a></li><li><a href="#conclusions" class="table-of-contents__link">Conclusions</a><ul><li><a href="#validators" class="table-of-contents__link">Validators</a></li><li><a href="#monitoring" class="table-of-contents__link">Monitoring</a></li></ul></li><li><a href="#resources" class="table-of-contents__link">Resources</a></li></ul></div></div></div></div></main></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/zh-CN/" class="nav-home"><img src="/zh-CN/img/Kusama_Canary_white.png" alt="Guide" width="66" height="58"></a><div><p class="homepage-font">Kusama is an experimental <br>community research and<br> development network.</p><a href="/zh-CN/docs/kusama-index" target="_blank" class="homepage-font">Docs</a><a href="https://kusama.network/" target="_blank" class="homepage-font">Kusama Network</a><a href="https://twitter.com/kusamanetwork" target="_blank" rel="noreferrer noopener" class="homepage-font">Twitter</a><a href="https://matrix.to/#/!HfRYKXBoPmDBCAWUEJ:polkadot.builders" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Watercooler (Element Chat)</a></div><a href="/kusama-wiki.zip" target="_blank" rel="noreferrer noopener">Download this Guide as PDF</a></section><section class="row"><div class="copyright homepage-font">© 2021 Web3 Foundation</div><a class="item homepage-font" href="https://polkadot.network/privacy/">Privacy Policy</a></section></footer></div>
<script src="/zh-CN/assets/js/runtime~main.0b6b002f.js"></script>
<script src="/zh-CN/assets/js/main.ba81d42f.js"></script>
</body>
</html>