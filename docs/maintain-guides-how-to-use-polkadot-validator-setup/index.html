<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="search" type="application/opensearchdescription+xml" title="Guide" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli&display=swap">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.js"></script>
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js" onload="addBackToTop()" defer="defer"></script>
<script src="https://apisa.web3.foundation/latest.js" async defer="defer"></script>
<script src="../js/custom.js"></script>
<script src="../js/clipboard.min.js"></script>
<script src="../js/copycode.js"></script><title data-react-helmet="true">How to use Polkadot Validator Setup · Guide</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://guide.kusama.network/docs/maintain-guides-how-to-use-polkadot-validator-setup"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How to use Polkadot Validator Setup · Guide"><meta data-react-helmet="true" name="description" content="Steps on Web3 Foundation&#x27;s supported validator setup."><meta data-react-helmet="true" property="og:description" content="Steps on Web3 Foundation&#x27;s supported validator setup."><link data-react-helmet="true" rel="icon" href="/img/Kusama_Canary_white.png"><link data-react-helmet="true" rel="canonical" href="https://guide.kusama.network/docs/maintain-guides-how-to-use-polkadot-validator-setup"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-how-to-use-polkadot-validator-setup" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/zh-CN/docs/maintain-guides-how-to-use-polkadot-validator-setup" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://guide.kusama.network/docs/maintain-guides-how-to-use-polkadot-validator-setup" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.0950cafb.css">
<link rel="preload" href="/assets/js/runtime~main.4bf2f5cf.js" as="script">
<link rel="preload" href="/assets/js/main.b2f62492.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Kusama_logotype_white_large.png" alt="Guide" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/Kusama_logotype_white_large.png" alt="Guide" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Guide</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/kusama-getting-started">Docs</a><div class="searchBox_qEbK"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/docs/contributing">Contribute</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/maintain-guides-how-to-use-polkadot-validator-setup" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-CN/docs/maintain-guides-how-to-use-polkadot-validator-setup" target="_self" rel="noopener noreferrer" class="dropdown__link">中文</a></li><li><a href="https://crowdin.com/project/polkadot-wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help us translate</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><main class="docMainContainer_TCnq docMainContainerEnhanced_WDCb"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Polkadot Validator Setup</h1><p>The following guide will walk you through using Web3 Foundation&#x27;s <a href="https://github.com/w3f/polkadot-validator-setup" target="_blank" rel="noopener noreferrer">polkadot validator setup</a> to
offer a potential setup for your validator that aims to prevent some types of potential attacks
at the TCP layer and layers below. This will work for Polkadot and Kusama out of the box, and,
if you&#x27;re using another Substrate-based chain, it should work with some tweaks.</p><blockquote><p>NOTE: This setup should not be assumed to include the best security practices. It is up to
you to add additional security hardening.</p></blockquote><blockquote><p>Also, the current version of polkadot validator setup doesn&#x27;t allow for the creation and
configuration of sentry nodes.</p></blockquote><p>There are two ways that the setup can be configured:</p><ol><li><p><strong>Platform &amp; Application Layer</strong> which allows for configuring the credentials for
infrastructure providers, then executes the Terraform process to automatically deploy
the required machines (Platform Layer) and setup the Application Layer. This configuration
uses <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a> for defining and managing your infrastructure.</p></li><li><p><strong>Application Layer</strong> which allows for setting up Debian-based machines, where you only
need basic SSH access and configure those in an inventory. The Ansible scripts will setup
the entire Application Layer. This configuration uses <a href="https://www.ansible.com/" target="_blank" rel="noopener noreferrer">Ansible</a>
as an automation tool for setting up the VPN, Firewall, and the validator node. It supports
a few different cloud providers such as AWS, Microsoft Azure, GCP, and Packet.</p></li></ol><blockquote><p>Please file an <a href="https://github.com/w3f/polkadot-validator-setup/issues" target="_blank" rel="noopener noreferrer">issue</a> if you would like to make a feature request or report a bug for this setup.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="dependencies">Dependencies<a class="hash-link" href="#dependencies" title="Direct link to heading">​</a></h2><p>The initial step is to install the software dependencies for running the validator setup scripts. We
will need to acquire NodeJS, Yarn, Terraform, and Ansible. Usually, these are readily available using
your operating system&#x27;s package manager. Instructions may vary depending on which system you are on;
the instructions below demonstrate the commands for a user of a <em>Debian</em> or <em>Ubuntu-based</em> system.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="nodejs">NodeJS<a class="hash-link" href="#nodejs" title="Direct link to heading">​</a></h3><p>We recommend using <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener noreferrer">nvm</a> as a tool to manage different NodeJS versions across projects.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install curl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -sL https://deb.nodesource.com/setup_13.x | sudo -E bash -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install nodejs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">node -v  (Check your node version)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="yarn">Yarn<a class="hash-link" href="#yarn" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;deb https://dl.yarnpkg.com/debian/ stable main&quot; | sudo tee /etc/apt/sources.list.d/yarn.list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install yarn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="terraform">Terraform<a class="hash-link" href="#terraform" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install unzip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https://releases.hashicorp.com/terraform/0.12.16/terraform_0.12.16_linux_amd64.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unzip terraform_0.12.16_linux_amd64.zip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo mv terraform /usr/local/bin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform --version  (Check whether it is configured properly)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="ansible">Ansible<a class="hash-link" href="#ansible" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-add-repository ppa:ansible/ansible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install ansible -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt-get install python -y</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="deployment">Deployment<a class="hash-link" href="#deployment" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-one-clone-the-repository">Step One: Clone the repository<a class="hash-link" href="#step-one-clone-the-repository" title="Direct link to heading">​</a></h3><p>The first step is to clone the <code>polkadot-validator-setup</code> guide locally.</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone git@github.com:w3f/polkadot-secure-validator.git</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now you can <code>cd</code> into the <code>polkadot-validator-setup</code> directory and start to change the
configurations to match your custom deployment. However, before we start tweaking those, let&#x27;s start
by creating two new SSH keys that we (or rather, the Ansible playbooks) will use to access the
machines.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="step-two-generate-the-ssh-keys">Step Two: Generate the SSH keys<a class="hash-link" href="#step-two-generate-the-ssh-keys" title="Direct link to heading">​</a></h3><p>We will use <a href="https://en.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener noreferrer">SSH</a>, a remote shell tool, to access our validator. You will
first use the <code>ssh-keygen</code> command to generate a key for your validator.</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-keygen -m pem -f id_rsa_validator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-keygen -m pem -f id_rsa_public</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Be sure to add these keys to your SSH agent. First make sure your SSH agent is evaluated, then add
the keys to them.</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ eval $(ssh-agent)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add id_rsa_validator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add id_rsa_public</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>For this tutorial we will not set a passphrase for the SSH key, although usually that would be
recommended.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="configuration">Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">​</a></h3><p>After you have installed all the required software and made your ssh keys, you can start to
configure your infrastructure deployment by following the instructions. Start by cloning the
<code>polkadot-validator-setup</code> repository locally, and installing the package dependencies. Then
customize the configuration how you want it.</p><p>First run yarn to install the NodeJS dependencies:</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ yarn</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Now you can copy the configuration sample and start to customize it.</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ cp config/main.sample.json config/main.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># now you should customize config/main.json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Under <code>validators</code> and <code>publicNodes</code>, specify which cloud provider you want to use, the type of
machine specification, the number of validators you are going to deploy, the machine location, and
the user to use for SSH.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="getting-the-authorization-keys">Getting the authorization keys<a class="hash-link" href="#getting-the-authorization-keys" title="Direct link to heading">​</a></h4><p>The validator setup supports Google Cloud, AWS, Microsoft Azure, and Packet. For this
tutorial we will be using Google Cloud.</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="log-in-to-the-google-cloud-console">Log in to the Google Cloud console<a class="hash-link" href="#log-in-to-the-google-cloud-console" title="Direct link to heading">​</a></h5><p>You will need to log in to the google cloud console in order to access your authorization keys.</p><p>In the IAM&amp;Admin panel you will navigate to service accounts. Download JSON for service account key.</p><p>Make sure to also auth into your account like so:</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ gcloud auth login</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>And don&#x27;t forget to enable the compute engine!</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="configuration-options">Configuration Options<a class="hash-link" href="#configuration-options" title="Direct link to heading">​</a></h4><p>The other options can be mostly self explanatory. Here&#x27;s some tips on what they are and how you can
use them:</p><p>In the <code>additionalFlags</code> option, configure any of the additional flags you want to run for your
validator. If you want to run with a specific name, this is where you would enter it.</p><p>Under the <code>polkadotBinary.url</code> field you can provide the release that is hosted in the <a href="https://github.com/w3f/polkadot/releases" target="_blank" rel="noopener noreferrer">W3F
repository</a> or use an alternate one that you build and publish yourself.</p><p>By enabling the <code>nodeExporter</code>, Ansible will install and configure the <a href="https://github.com/prometheus/node_exporter" target="_blank" rel="noopener noreferrer">node_exporter</a>, which will
expose hardware-level metrics of your node in a format compatible with Prometheus.</p><p>The field <code>machineType:</code> will configure the machine&#x27;s hardware specifications, check
<a href="https://cloud.google.com/compute/docs/machine-types" target="_blank" rel="noopener noreferrer">here</a> for the configuration options for GCP. The other hosting providers should
have similar pages in their documentation.</p><p>Under <code>provider</code> the option are <code>gcp</code> (Google Cloud Provider), <code>aws</code> (AWS), <code>azure</code> (Microsoft
Azure) and <code>packet</code> for Packet.</p><p>The field <code>count</code> is the number of instances you would like to create.</p><p>The <code>location</code> and <code>zone</code> fields are for the location of the machine, for GCP check
<a href="https://cloud.google.com/compute/docs/regions-zones/" target="_blank" rel="noopener noreferrer">here</a>, other cloud providers will have similar documentation.</p><p>The <code>telemetryUrl</code> field will send your node&#x27;s information to a specific telemetry server. You could
send all your nodes&#x27; data (e.g. IP address) to the public endpoint, but it is highly recommended
that that you set up your own telemetry server to protect your validator’s data from being exposed
to the public. If you want to do that, see <a href="https://github.com/paritytech/substrate-telemetry" target="_blank" rel="noopener noreferrer">substrate telemetry source</a>.</p><blockquote><p>NOTE: If you decided to send your node’s information to public telemetry, the name for your
validator and public node that is displayed on the telemetry would look something like
<code>PROJECT_NAME-sv-public-0</code> / <code>PROJECT_NAME-sv-validator-0</code>.</p></blockquote><p>Configure <code>projectId</code> to be the name of the project you want to use in GCP.</p><p>Configure <code>sshUser</code> to be the user that manages your machine.</p><p>For different cloud providers, you need to set the corresponding credentials as environment
variables, for example, on GCP you only need to set <code>GOOGLE_APPLICATION_CREDENTIALS</code>. This variable
is the path to the JSON file containing the credentials of the service account you wish to use; this
service account needs to have write access to compute and network resources if you use GCP. For
others, you can check that by referring to the <a href="https://github.com/w3f/polkadot-validator-setup#prerequisites" target="_blank" rel="noopener noreferrer">README</a>.</p><p>Besides that, you need two additional environment variables that will allow Ansible to connect to
the created machines. These values of these variables will be the keys that you generated at the
beginning of the guide.</p><blockquote><p><code>SSH_ID_RSA_PUBLIC</code> - Path to private SSH key you want to use for the public nodes.</p></blockquote><blockquote><p><code>SSH_ID_RSA_VALIDATOR</code> - Path to private SSH key you want to use for the validator.</p></blockquote><blockquote><p>NOTE: You will need to configure the Compute Engine API and enable billing on your GCP accounts to
properly run these scripts.</p></blockquote><p>After everything is configured properly, you can start to run the deployment with:</p><div class="codeBlockContainer_I0IT language-zsh theme-code-block"><div class="codeBlockContent_wNvx zsh"><pre tabindex="0" class="prism-code language-zsh codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ scripts/deploy.sh</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><blockquote><p>NOTE: Certain steps of the process may hang, however the scripts are idempotent so you simply need
to re-run them and</p></blockquote><p>When the deployment and configuration is completed, you should see some output that looks like
what&#x27;s below. You are able to find the validator’s session keys by searching for &quot;show rotateKeys
output&quot;.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">TASK [polkadot-validator-session-info : retrieve session info] *****************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ok: [34.80.70.172]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLAY RECAP *********************************************************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">34.80.224.231              : ok=41   changed=1    unreachable=0    failed=0    skipped=11   rescued=0    ignored=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">34.80.70.172               : ok=49   changed=1    unreachable=0    failed=0    skipped=14   rescued=0    ignored=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">35.189.183.66              : ok=41   changed=1    unreachable=0    failed=0    skipped=11   rescued=0    ignored=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Done</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Done in 131.85s.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Also you can use <code>sshUser</code> to access one of the created instances that shows above.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">TASK [polkadot-validator : show rotateKeys output] *****************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ok: [34.80.70.172] =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;rotate_keys&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;changed&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;connection&quot;: &quot;close&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;content_length&quot;: &quot;295&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;content_type&quot;: &quot;application/json; charset=utf-8&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cookies&quot;: {},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;cookies_string&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;date&quot;: &quot;Sun, 24 Nov 2019 12:13:42 GMT&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;elapsed&quot;: 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;failed&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;json&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;id&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;jsonrpc&quot;: &quot;2.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;result&quot;: &quot;0xf126b68841f51988b37780fa5b224b2aa86888a8d3962a63595dbc4d85baac2dee7c9900c8ddfad1991a8884e58273f06d5c1dbfc3dc6000c037185ccead9d692a3b3396cdd7e2def520682d65ad7e8ca234fb17630b428752e6150462998b4362a2b7e201657c8084ae8215bd142458ccd69506d08b18925dc897fb95f54249&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;msg&quot;: &quot;OK (295 bytes)&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;redirected&quot;: false,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;status&quot;: 200,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;url&quot;: &quot;http://localhost:9933&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>The result &quot;0xf126b68841f5…..95f54249&quot; is your session key. Set this to your controller account in
<a href="https://polkadot.js.org/apps/#/staking/actions" target="_blank" rel="noopener noreferrer">Polkadot-JS Apps</a>.</p><p>After accessing one of the machines through SSH, you can keep track of the node’s status by running
<code>journalctl --follow -u polkadot</code>, which will show the latest synced block information.</p><p>Every time you change something in <code>main.json</code>, you can simply run <code>./scripts/deploy.sh</code> to update
it.</p><p>Congratulations! You have successfully deployed a secure validator. Free feel to open an issue if
you have any suggestions.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/w3f/polkadot-wiki/edit/master/docs/maintain/maintain-guides-how-to-use-polkadot-validator-setup.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-10-23T05:27:09.000Z">10/23/2021</time></b> by <b>Danny Salman</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#dependencies" class="table-of-contents__link toc-highlight">Dependencies</a><ul><li><a href="#nodejs" class="table-of-contents__link toc-highlight">NodeJS</a></li><li><a href="#yarn" class="table-of-contents__link toc-highlight">Yarn</a></li><li><a href="#terraform" class="table-of-contents__link toc-highlight">Terraform</a></li><li><a href="#ansible" class="table-of-contents__link toc-highlight">Ansible</a></li></ul></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a><ul><li><a href="#step-one-clone-the-repository" class="table-of-contents__link toc-highlight">Step One: Clone the repository</a></li><li><a href="#step-two-generate-the-ssh-keys" class="table-of-contents__link toc-highlight">Step Two: Generate the SSH keys</a></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Kusama_Canary_white.png" alt="Guide" width="66" height="58"></a><div><a href="https://kusama.network/" target="_blank" class="homepage-font">Kusama Network</a><a href="https://polkadot.network/faq/" target="_blank" rel="noreferrer noopener" class="homepage-font">FAQ</a><a href="https://twitter.com/kusamanetwork" target="_blank" rel="noreferrer noopener" class="homepage-font">Twitter</a><a href="https://www.notion.so/web3foundation/Polkadot-Kusama-Community-Hub-ee1fd077ff6c42c381940404f6aa9f1c" target="_blank" rel="noreferrer noopener" class="homepage-font">Community Hub</a><a href="https://matrix.to/#/!HfRYKXBoPmDBCAWUEJ:polkadot.builders" target="_blank" rel="noreferrer noopener" class="homepage-font">Kusama Watercooler</a><a href="https://github.com/w3f/General-Grants-Program" target="_blank" rel="noreferrer noopener" class="homepage-font">Grants and Bounties</a></div><div class="kusama-mainpage-cyber-row"><div class="kusama-mainpage-column"><h2 class="homepage-font-footer">Join a cyber secret society</h2><p class="homepage-font-footer">The Kappa Sigma Mu fraternity asks you to get a Kusama tattoo to join.</p><a href="/docs/maintain-guides-society-kusama"><button class="kusama-mainpage-build-footer">See Kappa Sigma Mu</button></a></div></div></section><section class="row"><div class="copyright homepage-font">© 2022 Web3 Foundation</div><a class="item homepage-font" href="https://polkadot.network/privacy/">Privacy Policy</a></section></footer></div>
<script src="/assets/js/runtime~main.4bf2f5cf.js"></script>
<script src="/assets/js/main.b2f62492.js"></script>
</body>
</html>